<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team2.nextpage.query.reaction.mapper.ReactionMapper">

    <select id="findCommentsByBookId" resultType="CommentDto">
        SELECT
            c.comment_id,
            c.content,
            u.user_nicknm AS writerNicknm,
            c.created_at,
            c.parent_id AS parentId
        FROM comments c
                 JOIN users u ON c.writer_id = u.user_id
        WHERE c.book_id = #{bookId}
          AND c.deleted_at IS NULL
        ORDER BY c.created_at ASC, c.comment_id ASC
    </select>

</mapper>